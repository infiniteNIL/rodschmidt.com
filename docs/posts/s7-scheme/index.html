<!doctype html><html lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><link rel=canonical href=https://rodschmidt.com/posts/s7-scheme/><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.153.2"><title>Mixing Swift and Lisp in Your iOS App - S7 Scheme • Rod Schmidt</title><meta name=twitter:card content="summary"><meta name=twitter:title content="Mixing Swift and Lisp in Your iOS App - S7 Scheme"><meta name=twitter:description content="I am a fan of Lisp. I was first attracted to it because it was the original language of artificial intelligence because of its ability to manipulate symbols and its own code. I spent a whole year using Lisp in a series of courses on artificial intelligence in college. I became quite adept at using it and quite enjoyed using it as well.
My Obsession Lately, I’ve become kind of obsessed with being able to use Lisp in my iOS apps. I want to put a Lisp interpreter in my app and program my business logic in Lisp. Every once in an awhile I get the urge to figure it out, try, and fail. This keeps happening."><meta name=twitter:site content="@rodschmidt"><meta property="og:url" content="https://rodschmidt.com/posts/s7-scheme/"><meta property="og:site_name" content="Rod Schmidt"><meta property="og:title" content="Mixing Swift and Lisp in Your iOS App - S7 Scheme"><meta property="og:description" content="I am a fan of Lisp. I was first attracted to it because it was the original language of artificial intelligence because of its ability to manipulate symbols and its own code. I spent a whole year using Lisp in a series of courses on artificial intelligence in college. I became quite adept at using it and quite enjoyed using it as well.
My Obsession Lately, I’ve become kind of obsessed with being able to use Lisp in my iOS apps. I want to put a Lisp interpreter in my app and program my business logic in Lisp. Every once in an awhile I get the urge to figure it out, try, and fail. This keeps happening."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-22T21:07:11-07:00"><meta property="article:modified_time" content="2025-12-22T21:07:11-07:00"><meta property="article:tag" content="Swift"><meta property="article:tag" content="Lisp"><meta property="article:tag" content="Apple Platforms"><link rel=stylesheet href=https://rodschmidt.com/scss/triple-hyde.76261012483a44a81b1b96dabaf00aca4680e421c2ed623d6b52fc84f960ae3d.css integrity="sha256-diYQEkg6RKgbG5bauvAKykaA5CHC7WI9a1L8hPlgrj0="><link rel=stylesheet href=https://rodschmidt.com/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://rodschmidt.com/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://rodschmidt.com/favicon.png></head><body><div class=sidebar><div class=container><div class=sidebar-about><span class=site__title><a href=https://rodschmidt.com/>Rod Schmidt</a></span><div class=author-image><img src="https://www.gravatar.com/avatar/e72ca1d6149c220065acbb01cd9f5d01?s=240&d=mp" class="img--circle img--headshot element--center" alt=gravatar></div><p class=site__description>Thoughts on Software Development</p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>Rod Schmidt</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=https://rodschmidt.com/about/><span>About</span></a></li><li><a href=https://rodschmidt.com/posts/><span>Posts</span></a></li><li><a href=https://rodschmidt.com/tags/><span>Tags</span></a></li><li><a href=https://rodschmidt.com/index.xml><span>RSS</span></a></li></ul></div><section class=social><a href=https://twitter.com/rodschmidt rel=me><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></a><a href=https://github.com/infinitenil rel=me><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a href=https://linkedin.com/in/rodschmidt rel=me><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></section></div></div><div class=copyright>&copy; 2025 Rod Schmidt</div></div></div><div class="content container"><article><header><h1>Mixing Swift and Lisp in Your iOS App - S7 Scheme</h1><div class=post__meta><i class="fas fa-calendar-alt"></i> Dec 22, 2025<br><i class="fas fa-tags"></i>
<a class="badge badge-tag" href=https://rodschmidt.com/tags/swift>swift</a>
<a class="badge badge-tag" href=https://rodschmidt.com/tags/lisp>lisp</a>
<a class="badge badge-tag" href=https://rodschmidt.com/tags/apple-platforms>apple platforms</a><br><i class="fas fa-clock"></i> 3 min read</div></header><div class=post><p>I am a fan of <a href=https://en.wikipedia.org/wiki/Lisp_%28programming_language%29>Lisp</a>. I was first attracted to it because it was the original language of artificial intelligence because of its ability to manipulate symbols and its own code. I spent a whole year using Lisp in a series of courses on artificial intelligence in college. I became quite adept at using it and quite enjoyed using it as well.</p><h2 id=my-obsession>My Obsession</h2><p>Lately, I’ve become kind of obsessed with being able to use Lisp in my iOS apps. I want to put a Lisp interpreter in my app and program my business logic in Lisp. Every once in an awhile I get the urge to figure it out, try, and fail. This keeps happening.</p><p>I know it’s pretty impractical, but the obsession is there. Besides, there are advantages to using higher level languages to better represent your problem space. Lisp excels at creating domain-specific languages (DSLs) for whatever problem you’re working on.</p><p>The current king of the Lisp world is Clojure, and that is the obvious place to start. However, it’s not that easy to embed a Clojure interpreter in your app. Believe me, I’ve tried.</p><p>I’ve tried embedding interpreters for <a href=https://clojure.org>Clojure</a>, <a href=https://clojurescript.org>ClojureScript</a>, and various dialects of <a href=https://www.scheme.org>Scheme</a>. Despite some people having accomplished it, I&rsquo;ve had no success. Their examples were out of date, often over a decade old, and I couldn’t get anything to compile or integrate with the modern version of an Xcode project for an iOS app. A lot of the difficulty is around the fact that the library for a Lisp implementation needs to be compiled for iOS. A lot of the dialects support macOS and it is easy to compile for macOS. iOS is harder because you’re basically cross-compiling and there’s a lot of configuration involved.</p><p>Recently though, I’ve made some breakthroughs. With a little help from some LLMs, I was able to get multiple variations of a Lisp interpreter into my iOS app.</p><h2 id=s7-scheme>S7 Scheme</h2><p>The first one I want to talk about is <a href=https://ccrma.stanford.edu/software/snd/snd/s7.html>S7</a> scheme. At first, I tried <a href=https://synthcode.com/scheme/chibi>Chibi</a> Scheme, but even with Claude, I couldn’t get that to work. Claude suggested S7, so I switched to that. It’s probably the easiest to integrate because it consists of just 2 files: s7.h and s7.c. Just add those 2 files to your project, add a bridging header, compile, and you should be good to go. Except, it’s not quite that simple when compiling for iOS.</p><p>The first error you get is <em>“system() has been explicitly marked unavailable here.”</em> The C <code>system</code>() call is not available on iOS because of the sandbox. To fix that just add <code>#define WITH_SYSTEM_EXTRAS=0</code> to s7.c. Make sure to add it before other #includes that may need it.</p><p>Next, you’ll get a bunch of warnings when compiling s7.c. These are just annoying and harmless. To suppress these, go to the Build Phases of your project, open up the Compile Sources phase and double-click on s7.c. A popover will appear where you can enter some compiler flags that will just apply to s7.c. Add these flags:</p><blockquote><p>-Wno-shorten-64-to-32 -Wno-conversion -Wno-shorten-64-to-32 -Wno-unreachable-code -Wno-conversion -Wno-comma -Wno-conditional-uninitialized</p></blockquote><p>With that, everything will build cleanly.</p><h2 id=a-swift-wrapper>A Swift Wrapper</h2><p>My example includes a Swift class called <code>S7SchemeInterpreter</code>. It handles all the bridging between calling S7’s C API and Swift. It handles the following:</p><ul><li>initializing and deinitializing S7</li><li>evaluating Scheme code and getting the result back as a Swift type.</li><li>loading Scheme code</li><li>defining Scheme variables from Swift</li><li>calling Scheme functions from Swift</li><li>Converting S7 types to Swift types and vice-versa.</li><li>Registering Swift functions that can be called from your Scheme code.</li></ul><h1 id=conclusion>Conclusion</h1><p>That’s it. A working scheme interpreter embedded in your iOS app. Create DSLs. Provide an extension language to your users. Write code in a dynamic language and functional language.</p><p>A repo with a working example is <a href=https://github.com/infiniteNIL/S7Test>here</a>.</p></div><script async data-uid=d20275c87b src=https://rodschmidt.kit.com/d20275c87b/index.js></script><div class="navigation navigation-single"><a href=https://rodschmidt.com/posts/numerology-history-6/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i>
<span class=navigation-tittle>Numerology: 17 Years in the App Store (Part 6)</span>
</a><a href=https://rodschmidt.com/posts/scittle/ class=navigation-next><span class=navigation-tittle>Mixing Swift and Clojure in Your iOS App - Scittle</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div></body></html>